{"title":"Evolución Demográfica en España","markdown":{"yaml":{"title":"Evolución Demográfica en España","author":["Marian Delfa Baena","Abel Guarinos Marin","Xavier Vidal Roselló"],"date":"2025-12-06","date-format":"short","format":{"revealjs":{"theme":"white","mainfont":"Verdana","monofont":"Fira Code","background-color":"#FCFCFC","fontcolor":"#333333","highlight-style":"a11y","center-title-slide":true,"title-slide-attributes":{"data-background-color":"#B22222","data-color":"#FFFFFF"},"scrollable":true,"slide-level":2,"height":900,"width":1600,"toc":false,"preview-links":"auto","link-external-newwindow":true,"transition":"fade","code-line-numbers":true,"number-sections":false,"slide-number":"c/t","incremental":false}},"footer":"Evolución Demográfica en España - BigData\n"},"headingText":"Intro","containsRefs":false,"markdown":"\n\n\nHemos usado para el análisis demográfico datos extraidos de Euroestat, el repo de Github está [aquí](https://github.com/mariandelfa/demoesp) y la página web del paquete está [aquí](https://mariandelfa.github.io/demoesp/).\n\nLos datos se pueden cargar en la memoria de de R/RStudio de esta forma:\n\n```{r}\n#| label: carga-datos-eurostat\n#| warning: false\n#| message: false\n#| output: false\n\nlibrary(ggplot2)\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(eurostat) \nlibrary(lubridate)\n\ndf_eurostat_raw <- get_eurostat(\"demo_r_d2jan\")\n\ndf_limpio <- df_eurostat_raw %>%\n  rename_with(~ \"time\", any_of(\"TIME_PERIOD\")) %>%\n  rename_with(~ \"geo\", any_of(\"geo\")) \n```\n\n----------------------\n\n## 1. Propensión del crecimiento\n\nVamos a ver una tabla con el resultado de la tendencia poblacional desde el 2019 al 2023.\n\n\n```{r}\n#| warning: false\n#| message: false\n\ndf_spain <- df_limpio %>%\n  mutate(año = year(time)) %>%\n  filter(\n    geo == \"ES\",        # España\n    sex == \"T\",         # Total\n    age == \"TOTAL\",     # Total edad\n    año >= 2019 & año <= 2023\n  ) %>%\n  select(año, poblacion_total = values) %>%\n  arrange(año) %>%\n  mutate(\n    diferencia = poblacion_total - lag(poblacion_total),\n    tendencia = ifelse(diferencia >= 0, \"Positiva\", \"Negativa\")\n  )\n\nkable(df_spain, caption = \"Tabla: Datos Eurostat\")\n```\n\n------------------------------------------------------------------------\n\n## 2. Gráfico de la población total\n\nA continuación, generamos un gráfico de líneas sobre la evolución demográfica.\n\n```{r}\n#| label: grafico-poblacion\n#| fig-align: center\n\nggplot(data = df_spain, aes(x = año, y = poblacion_total)) +\n  # Línea de tendencia en color rojo \n  geom_line(color = \"#B22222\", linewidth = 1.2) + \n  # Puntos destacados en azul \n  geom_point(size = 4, color = \"#2C3E50\") +\n  # Etiquetas de texto con la cifra \n  geom_text(aes(label = round(poblacion_total / 1000000, 2)), \n            vjust = -1, size = 3.5, color = \"#555555\") +\n  # Ajustes de escalas\n  scale_y_continuous(labels = scales::comma, limits = c(46000000, 49000000)) +\n  scale_x_continuous(breaks = df_spain$año) +\n  theme_minimal() +\n  # Títulos y descripción\n  labs(\n    title = \"Evolución de la población Española\",\n    subtitle = \"Cifras en millones de habitantes\",\n    x = \"Año\",\n    y = \"Población total\",\n    caption = \"Fuente: Elaboración propia basado en los datos de Eurostat\"\n  ) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 16, color = \"#2C3E50\"),\n    plot.subtitle = element_text(face = \"italic\", color = \"#666666\"),\n    panel.grid.minor = element_blank() \n  )\n```\n\n\n------------------------------------------------------------------------\n\n## 3. Contexto Geográfico\n\nEsta imagen muestra cómo la población se concentra en las costas y en Madrid, dejando el interior mucho más vacío.\n\n```{r}\n#| echo: false\nmy_url <- \"https://tse1.mm.bing.net/th/id/OIP.F0wIgaazuGD47jt4RcAyBQHaGD?cb=ucfimg2&ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3\"\n```\n\n![Mapa densidad de España](https://tse1.mm.bing.net/th/id/OIP.F0wIgaazuGD47jt4RcAyBQHaGD?cb=ucfimg2&ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3)\n\n------------------------------------------------------------------------\n\nIncluso podemos ver la comparación de la densidad con el año 2021\n\n::: column-margin\n![](./imagenes/imagen_02.png){fig-align=\"center\"}\n:::\n\n------------------------------------------------------------------------\n\n## 4. Gráficos del análisis\n\nSon tres gráficos de evolución demográfica en las comunidades autónomas más representativas de España\n\n```{r}\n#| label: grafico-comunidades\n#| warning: false\n#| message: false\n#| fig-align: center\n\nlibrary(scales) # Para las comas en los números :)\n\n# Si por seguridad quieres asegurarte de que existe:\nif (!exists(\"df_limpio\")) {\n   # (Solo se ejecuta si saltaste el bloque 1)\n   raw <- get_eurostat(\"demo_r_d2jan\")\n   df_limpio <- raw %>% rename_with(~ \"time\", any_of(\"TIME_PERIOD\"))\n}\n\ndf_ccaa <- df_limpio %>%\n  mutate(año = year(time)) %>%\n  filter(\n    geo %in% c(\"ES30\", \"ES43\", \"ES52\"), # Madrid, Extremadura, Valencia\n    sex == \"T\",\n    age == \"TOTAL\",\n    año >= 2019 & año <= 2023\n  ) %>%\n  mutate(Comunidad = case_when(\n    geo == \"ES30\" ~ \"Madrid\",\n    geo == \"ES43\" ~ \"Extremadura\",\n    geo == \"ES52\" ~ \"C. Valenciana\"\n  ))\n\nggplot(df_ccaa, aes(x = año, y = values, color = Comunidad)) +\n  geom_line(linewidth = 1) +      \n  geom_point(size = 3) +                             \n  facet_wrap(~Comunidad, scales = \"free_y\") +      \n  theme_minimal() +  \n  scale_y_continuous(labels = label_comma()) +\n  scale_x_continuous(breaks = 2019:2023) +\n  labs(title = \"Evolución por Comunidad Autónoma\", y = \"Habitantes\") +\n  theme(legend.position = \"none\")\n```\n\n---------\n\n## 5. Pirámide poblacional\n\nSeguidamente, creamos la pirámide poblacional.\n\n```{r}\n#| label: piramide-poblacion\n#| fig-align: center\n#| fig-height: 5\n\n# 1. Data frame de la estructura piramidal de España (Hombres negativo, Mujeres positivo)\ndf_piramide <- data.frame(\n  grupo_edad = factor(rep(c(\"0-14\", \"15-29\", \"30-44\", \"45-59\", \"60-74\", \"75+\"), 2),\n                      levels = c(\"0-14\", \"15-29\", \"30-44\", \"45-59\", \"60-74\", \"75+\")),\n  sexo = c(rep(\"Hombres\", 6), rep(\"Mujeres\", 6)),\n  poblacion = c(\n    -3.2, -3.8, -5.0, -5.8, -4.1, -2.1,  # Hombres (negativo)\n     3.0,  3.6,  4.9,  5.9,  4.5,  3.2   # Mujeres (positivo)\n  )\n)\n\n# 2. Pirámide\nggplot(df_piramide, aes(x = grupo_edad, y = poblacion, fill = sexo)) +\n  geom_col() +                       \n  coord_flip() +                     \n  scale_y_continuous(labels = abs) + \n  theme_minimal() +\n  labs(\n    title = \"Pirámide poblacional de España\",\n    subtitle = \"Pirámide seprada en dos géneros y en grupos de edades\",\n    x = \"Grupo de edad\",\n    y = \"Población relativa (Millones)\",\n    fill = \"\"\n  )\n```\n\n","srcMarkdownNoYaml":"\n\n## Intro \n\nHemos usado para el análisis demográfico datos extraidos de Euroestat, el repo de Github está [aquí](https://github.com/mariandelfa/demoesp) y la página web del paquete está [aquí](https://mariandelfa.github.io/demoesp/).\n\nLos datos se pueden cargar en la memoria de de R/RStudio de esta forma:\n\n```{r}\n#| label: carga-datos-eurostat\n#| warning: false\n#| message: false\n#| output: false\n\nlibrary(ggplot2)\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(eurostat) \nlibrary(lubridate)\n\ndf_eurostat_raw <- get_eurostat(\"demo_r_d2jan\")\n\ndf_limpio <- df_eurostat_raw %>%\n  rename_with(~ \"time\", any_of(\"TIME_PERIOD\")) %>%\n  rename_with(~ \"geo\", any_of(\"geo\")) \n```\n\n----------------------\n\n## 1. Propensión del crecimiento\n\nVamos a ver una tabla con el resultado de la tendencia poblacional desde el 2019 al 2023.\n\n\n```{r}\n#| warning: false\n#| message: false\n\ndf_spain <- df_limpio %>%\n  mutate(año = year(time)) %>%\n  filter(\n    geo == \"ES\",        # España\n    sex == \"T\",         # Total\n    age == \"TOTAL\",     # Total edad\n    año >= 2019 & año <= 2023\n  ) %>%\n  select(año, poblacion_total = values) %>%\n  arrange(año) %>%\n  mutate(\n    diferencia = poblacion_total - lag(poblacion_total),\n    tendencia = ifelse(diferencia >= 0, \"Positiva\", \"Negativa\")\n  )\n\nkable(df_spain, caption = \"Tabla: Datos Eurostat\")\n```\n\n------------------------------------------------------------------------\n\n## 2. Gráfico de la población total\n\nA continuación, generamos un gráfico de líneas sobre la evolución demográfica.\n\n```{r}\n#| label: grafico-poblacion\n#| fig-align: center\n\nggplot(data = df_spain, aes(x = año, y = poblacion_total)) +\n  # Línea de tendencia en color rojo \n  geom_line(color = \"#B22222\", linewidth = 1.2) + \n  # Puntos destacados en azul \n  geom_point(size = 4, color = \"#2C3E50\") +\n  # Etiquetas de texto con la cifra \n  geom_text(aes(label = round(poblacion_total / 1000000, 2)), \n            vjust = -1, size = 3.5, color = \"#555555\") +\n  # Ajustes de escalas\n  scale_y_continuous(labels = scales::comma, limits = c(46000000, 49000000)) +\n  scale_x_continuous(breaks = df_spain$año) +\n  theme_minimal() +\n  # Títulos y descripción\n  labs(\n    title = \"Evolución de la población Española\",\n    subtitle = \"Cifras en millones de habitantes\",\n    x = \"Año\",\n    y = \"Población total\",\n    caption = \"Fuente: Elaboración propia basado en los datos de Eurostat\"\n  ) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 16, color = \"#2C3E50\"),\n    plot.subtitle = element_text(face = \"italic\", color = \"#666666\"),\n    panel.grid.minor = element_blank() \n  )\n```\n\n\n------------------------------------------------------------------------\n\n## 3. Contexto Geográfico\n\nEsta imagen muestra cómo la población se concentra en las costas y en Madrid, dejando el interior mucho más vacío.\n\n```{r}\n#| echo: false\nmy_url <- \"https://tse1.mm.bing.net/th/id/OIP.F0wIgaazuGD47jt4RcAyBQHaGD?cb=ucfimg2&ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3\"\n```\n\n![Mapa densidad de España](https://tse1.mm.bing.net/th/id/OIP.F0wIgaazuGD47jt4RcAyBQHaGD?cb=ucfimg2&ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3)\n\n------------------------------------------------------------------------\n\nIncluso podemos ver la comparación de la densidad con el año 2021\n\n::: column-margin\n![](./imagenes/imagen_02.png){fig-align=\"center\"}\n:::\n\n------------------------------------------------------------------------\n\n## 4. Gráficos del análisis\n\nSon tres gráficos de evolución demográfica en las comunidades autónomas más representativas de España\n\n```{r}\n#| label: grafico-comunidades\n#| warning: false\n#| message: false\n#| fig-align: center\n\nlibrary(scales) # Para las comas en los números :)\n\n# Si por seguridad quieres asegurarte de que existe:\nif (!exists(\"df_limpio\")) {\n   # (Solo se ejecuta si saltaste el bloque 1)\n   raw <- get_eurostat(\"demo_r_d2jan\")\n   df_limpio <- raw %>% rename_with(~ \"time\", any_of(\"TIME_PERIOD\"))\n}\n\ndf_ccaa <- df_limpio %>%\n  mutate(año = year(time)) %>%\n  filter(\n    geo %in% c(\"ES30\", \"ES43\", \"ES52\"), # Madrid, Extremadura, Valencia\n    sex == \"T\",\n    age == \"TOTAL\",\n    año >= 2019 & año <= 2023\n  ) %>%\n  mutate(Comunidad = case_when(\n    geo == \"ES30\" ~ \"Madrid\",\n    geo == \"ES43\" ~ \"Extremadura\",\n    geo == \"ES52\" ~ \"C. Valenciana\"\n  ))\n\nggplot(df_ccaa, aes(x = año, y = values, color = Comunidad)) +\n  geom_line(linewidth = 1) +      \n  geom_point(size = 3) +                             \n  facet_wrap(~Comunidad, scales = \"free_y\") +      \n  theme_minimal() +  \n  scale_y_continuous(labels = label_comma()) +\n  scale_x_continuous(breaks = 2019:2023) +\n  labs(title = \"Evolución por Comunidad Autónoma\", y = \"Habitantes\") +\n  theme(legend.position = \"none\")\n```\n\n---------\n\n## 5. Pirámide poblacional\n\nSeguidamente, creamos la pirámide poblacional.\n\n```{r}\n#| label: piramide-poblacion\n#| fig-align: center\n#| fig-height: 5\n\n# 1. Data frame de la estructura piramidal de España (Hombres negativo, Mujeres positivo)\ndf_piramide <- data.frame(\n  grupo_edad = factor(rep(c(\"0-14\", \"15-29\", \"30-44\", \"45-59\", \"60-74\", \"75+\"), 2),\n                      levels = c(\"0-14\", \"15-29\", \"30-44\", \"45-59\", \"60-74\", \"75+\")),\n  sexo = c(rep(\"Hombres\", 6), rep(\"Mujeres\", 6)),\n  poblacion = c(\n    -3.2, -3.8, -5.0, -5.8, -4.1, -2.1,  # Hombres (negativo)\n     3.0,  3.6,  4.9,  5.9,  4.5,  3.2   # Mujeres (positivo)\n  )\n)\n\n# 2. Pirámide\nggplot(df_piramide, aes(x = grupo_edad, y = poblacion, fill = sexo)) +\n  geom_col() +                       \n  coord_flip() +                     \n  scale_y_continuous(labels = abs) + \n  theme_minimal() +\n  labs(\n    title = \"Pirámide poblacional de España\",\n    subtitle = \"Pirámide seprada en dos géneros y en grupos de edades\",\n    x = \"Grupo de edad\",\n    y = \"Población relativa (Millones)\",\n    fill = \"\"\n  )\n```\n\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"png","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"show","code-overflow":"wrap","code-link":true,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":{"method":"mathjax","url":"https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS_HTML-full"},"slide-level":2,"to":"revealjs","include-in-header":[{"text":"<link rel = \"shortcut icon\" href = \"imagenes/uv.jpeg\" />\n"}],"toc":false,"toc-depth":3,"highlight-style":"a11y","number-sections":false,"incremental":false,"output-file":"my_slides_BigData.html"},"language":{"toc-title-document":"Indice de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilizar","section-title-copyright":"Derechos de autor","section-title-citation":"Cita","appendix-attribution-cite-as":"Por favor cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de Publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Enseñar el código","code-tools-hide-all-code":"Esconder el código","code-tools-view-source":"Ver el código","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiada","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la busqueda","search-hide-matches-text":"Esconder resultados adicionales","search-more-match-text":"hay más resultados en este documento","search-more-matches-text":"más resultados en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Pre-seleccionado","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"Número de mayor a menor","listing-page-order-by-number-asc":"Número de menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de Archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Sub-título","listing-page-field-readingtime":"Tiempo para completar lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es","fig-responsive":false,"quarto-version":"1.8.24","auto-stretch":true,"lightbox":true,"anchor-sections":true,"other-links":[{"text":"Web del curso","href":"https://perezp44.github.io/intro-ds-25-26-web/"},{"text":"Trabajos de mis compañeros","href":"https://perezp44.github.io/intro-ds-25-26-web/05-trabajos-estudiantes.html"},{"text":"Repo del trabajo","href":"https://github.com/mariandelfa/trabajo_BigData_equipo"}],"toc-location":"right","toc-title":"Índicexxxx","crossref":{"fig-title":"Gráfico","tbl-title":"Tabla"},"fig-cap-location":"bottom","code-copy":true,"knitr":{"opts_chunk":{"collapse":true,"comment":"#>","fig.asp":"7/9","out.width":"95%","fig.align":"center","fig.show":"hold","R.options":"options(scipen = 999)"}},"editor_options":{"chunk_output_type":"console"},"license":"CC BY","title":"Evolución Demográfica en España","author":["Marian Delfa Baena","Abel Guarinos Marin","Xavier Vidal Roselló"],"date":"2025-12-06","date-format":"short","footer":"Evolución Demográfica en España - BigData\n","theme":"white","mainfont":"Verdana","monofont":"Fira Code","background-color":"#FCFCFC","fontcolor":"#333333","center-title-slide":true,"title-slide-attributes":{"data-background-color":"#B22222","data-color":"#FFFFFF"},"scrollable":true,"height":900,"width":1600,"previewLinks":"auto","transition":"fade","slideNumber":"c/t"}}},"projectFormats":["html"]}